/* eslint-disable @typescript-eslint/explicit-function-return-type */
import * as React from 'react';

import { IGridProps } from './IGridProps';
import { ResizeObserver } from '@juggle/resize-observer';
import { useGridStyles } from './useGridStyles';

export const Grid  = (
  props: React.PropsWithChildren<IGridProps>
) => {
  const { children, className } = props;
  const { gridStyles } = useGridStyles(props);
  const ref = React.useRef<HTMLDivElement>(null);
  
  const [width, setWidth] = React.useState(0);
  const [height, setHeight] = React.useState(0);

  React.useEffect(() => {
    let resizeObserver: ResizeObserver;
    if (ref.current) {
      // observer to detect changes in the size of the container 
        resizeObserver = new ResizeObserver((entries) => {
        for (const entry of entries) {
          const { width, height } = entry.contentRect;
          setWidth(width);
          setHeight(height);
        }
      });
      resizeObserver.observe(ref.current);
    }
    return () => {
      if (resizeObserver) {
        resizeObserver.disconnect();
      }
    }
  }, []);
  return (
    <>
      <div className={className} style={gridStyles(width, height)} ref={ref}>
        {children}
      </div>
    </>
  );
};
